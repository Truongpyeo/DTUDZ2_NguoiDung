{
  "backgroundColor": "#FFFFFF",
  "borderColor": "#E0DEDE",
  "borderRadius": "0.375rem",
  "borderWidth": "1",
  "bottomRow": 40,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "changeLocation": "{{storeValue('address', address).then(() => {\n  showAlert('chọn vị trí thành công', 'success');\n});}}",
  "defaultModel": "{{\n{\"map\" : JSObject1.getLocation.data,\n \"address\" : txt_diaChi.text}\n}}",
  "dynamicBindingPathList": [
    {
      "key": "theme"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "defaultModel"
    }
  ],
  "dynamicHeight": "AUTO_HEIGHT",
  "dynamicPropertyPathList": [],
  "dynamicTriggerPathList": [
    {
      "key": "changeLocation"
    }
  ],
  "events": [
    "changeLocation"
  ],
  "isCanvas": false,
  "isLoading": false,
  "isSearchWildcard": true,
  "isVisible": true,
  "key": "3wi76f8o7r",
  "leftColumn": 1,
  "maxDynamicHeight": 9000,
  "minDynamicHeight": 4,
  "mobileBottomRow": 56,
  "mobileLeftColumn": 0,
  "mobileRightColumn": 18,
  "mobileTopRow": 26,
  "needsErrorInfo": false,
  "originalBottomRow": 40,
  "originalTopRow": 8,
  "parentColumnSpace": 6.53125,
  "parentId": "r42499gv7x",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "rightColumn": 62,
  "shouldScrollContents": true,
  "srcDoc": {
    "css": "@charset \"UTF-8\";\n#map {\n  height: 250px;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.custom-popup .leaflet-popup-content-wrapper {\n  background: linear-gradient(145deg, #ffffff, #f3f3f3);\n  border-radius: 10px;\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);\n  border: 1px solid #ddd;\n}\n\n.custom-popup .leaflet-popup-content {\n  margin: 0;\n  padding: 0;\n}\n\nbody, html {\n  overflow-x: hidden;\n  overflow-y: hidden;\n  font-family: \"Roboto\", sans-serif;\n  background: #f9f9f9;\n  color: #333;\n}\n\n.popup-content {\n  min-width: 250px;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);\n}\n\n.popup-title {\n  background: linear-gradient(145deg, #0056b3, #003c71);\n  color: white;\n  margin: 0;\n  padding: 12px 20px;\n  font-size: 18px;\n  font-weight: bold;\n  border-radius: 8px 8px 0 0;\n}\n\n.popup-body {\n  padding: 15px;\n  color: #555;\n  font-size: 15px;\n  line-height: 1.6;\n  background-color: #fff;\n}\n\n.popup-footer {\n  padding: 10px 20px;\n  background: #f7f7f7;\n  color: #777;\n  font-size: 13px;\n  border-radius: 0 0 8px 8px;\n  text-align: right;\n}\n\n.custom-popup .leaflet-popup-tip {\n  background: #0056b3;\n}\n\n#sendAddress {\n  display: flex; /* Căn giữa icon và text */\n  align-items: center;\n  justify-content: center;\n  gap: 8px; /* Khoảng cách giữa icon và text */\n  margin: 10px auto;\n  padding: 10px 14px; /* Kích thước nhỏ gọn */\n  font-size: 14px;\n  background: linear-gradient(145deg, #007bff, #0056b3);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\n  transition: background-color 0.3s ease, transform 0.2s ease;\n  cursor: pointer;\n  width: auto; /* Linh hoạt kích thước */\n  max-width: 200px;\n}\n\n#sendAddress i {\n  font-size: 16px; /* Kích thước icon */\n}\n\n#sendAddress:hover {\n  background: linear-gradient(145deg, #0056b3, #00408a);\n  transform: translateY(-2px);\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);\n}\n\n#sendAddress:active {\n  background: linear-gradient(145deg, #00408a, #003367);\n  transform: translateY(0);\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n}\n\n/* Responsive cho thiết bị nhỏ hơn 768px */\n@media (max-width: 768px) {\n  #sendAddress {\n    width: 90%; /* Chiếm 90% chiều rộng màn hình */\n    max-width: none; /* Loại bỏ giới hạn max-width */\n    padding: 12px 16px; /* Tăng padding để dễ bấm hơn */\n    font-size: 14px;\n    gap: 10px;\n  }\n  #sendAddress i {\n    font-size: 18px; /* Icon lớn hơn trên màn hình nhỏ */\n  }\n}\n/* Responsive cho thiết bị rất nhỏ hơn 576px */\n@media (max-width: 576px) {\n  #sendAddress {\n    font-size: 13px; /* Cỡ chữ nhỏ hơn */\n    padding: 10px 12px;\n  }\n  #sendAddress i {\n    font-size: 16px; /* Giữ icon vừa phải */\n  }\n}",
    "html": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\t\t<title>Vue Inline Styles</title>\n\t\t<!-- Bootstrap -->\n\t\t<link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n\t\t<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\" />\n\t\t<!-- FontAwesome -->\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css\" integrity=\"sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\n\t</head>\n\t<body>\n\t\t<div id=\"app\">\n\t\t\t<div id=\"map\" class=\"map\"></div>\n\t\t\t<button id=\"sendAddress\" class=\"btn btn-primary mt-2\">\n\t\t\t\t<i class=\"fa-solid fa-location-dot\"></i> Chọn vị trí này\n\t\t\t</button>\n\n\t\t</div>\n\t\t<!-- Vue.js -->\n\t\t<script src=\"https://unpkg.com/vue@2.6.14/dist/vue.min.js\"></script>\n\t\t<script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n\t\t<script src=\"https://cdn.jsdelivr.net/npm/dtuappsmithmap@2.2.20/dist/index.umd.js\"></script>\n\t</body>\n</html>",
    "js": "appsmith.onReady(() => {\n  function createVueInstance() {\n    new Vue({\n      el: \"#app\",\n      data() {\n        return {\n          mapInstance: null,\n          currentPosition: appsmith.model.map || {\n            lat: 16.0464319,\n            lng: 108.2326082\n          },\n          // Default current position\n          searchPosition: null,\n          address: appsmith.model.address\n        };\n      },\n      async mounted() {\n        this.initMap();\n        this.mapInstance.capNhatViTriHienTai(this.currentPosition.lat, this.currentPosition.lng);\n        if (this.address) {\n          await this.search(this.address);\n        }\n        document.getElementById('sendAddress').addEventListener('click', this.sendAddress);\n      },\n      methods: {\n        initMap() {\n          this.mapInstance = new DTUAppsmithMap(\"map\", {\n            center: [this.currentPosition.lat, this.currentPosition.lng],\n            zoom: 15\n          });\n        },\n        async search(address) {\n          try {\n            const coordinates = await this.mapInstance.timKiemDiaChi(address);\n            this.searchPosition = coordinates;\n            this.mapInstance.taoDiaDiem(coordinates.lat, coordinates.lng, \"Vị trí tìm kiếm\", this.address, \"fa-solid fa-location-dot\");\n            this.mapInstance.setView([coordinates.lat, coordinates.lng], 16);\n\n            // Lưu coordinates vào Appsmith Store để sử dụng ở nơi khác\n            appsmith.triggerEvent('changeLocation', {\n              address: this.searchPosition\n            });\n\n            // Trigger event with coordinates\n            // appsmith.triggerEvent('changeLocation', { location: coordinates || this.currentPosition });\n          } catch (error) {\n            console.log(error);\n          }\n        },\n        sendAddress() {\n          // Trigger event with address\n          appsmith.triggerEvent('changeLocation', {\n            address: this.searchPosition || this.currentPosition\n          });\n        }\n      }\n      // watch: {\n      // address(newAddress) {\n      // if (newAddress) {\n      // this.search(newAddress);\n      // }\n      // }\n      // }\n    });\n  }\n  createVueInstance(); // Tạo instance khi Appsmith sẵn sàng\n\n  appsmith.onModelChange(() => {\n    createVueInstance(); // Tạo lại instance khi model thay đổi\n  });\n});"
  },
  "theme": "{{appsmith.theme}}",
  "topRow": 8,
  "type": "CUSTOM_WIDGET",
  "uncompiledSrcDoc": {
    "css": "#map {\n    height: 250px;\n    border-radius: 12px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.custom-popup .leaflet-popup-content-wrapper {\n    background: linear-gradient(145deg, #ffffff, #f3f3f3);\n    border-radius: 10px;\n    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);\n    border: 1px solid #ddd;\n}\n\n.custom-popup .leaflet-popup-content {\n    margin: 0;\n    padding: 0;\n}\n\nbody, html {\n    overflow-x: hidden;\n    overflow-y: hidden;\n    font-family: 'Roboto', sans-serif;\n    background: #f9f9f9;\n    color: #333;\n}\n\n.popup-content {\n    min-width: 250px;\n    border-radius: 8px;\n    overflow: hidden;\n    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);\n}\n\n.popup-title {\n    background: linear-gradient(145deg, #0056b3, #003c71);\n    color: white;\n    margin: 0;\n    padding: 12px 20px;\n    font-size: 18px;\n    font-weight: bold;\n    border-radius: 8px 8px 0 0;\n}\n\n.popup-body {\n    padding: 15px;\n    color: #555;\n    font-size: 15px;\n    line-height: 1.6;\n    background-color: #fff;\n}\n\n.popup-footer {\n    padding: 10px 20px;\n    background: #f7f7f7;\n    color: #777;\n    font-size: 13px;\n    border-radius: 0 0 8px 8px;\n    text-align: right;\n}\n\n.custom-popup .leaflet-popup-tip {\n    background: #0056b3;\n}\n\n#sendAddress {\n    display: flex; /* Căn giữa icon và text */\n    align-items: center;\n    justify-content: center;\n    gap: 8px; /* Khoảng cách giữa icon và text */\n    margin: 10px auto;\n    padding: 10px 14px; /* Kích thước nhỏ gọn */\n    font-size: 14px;\n    background: linear-gradient(145deg, #007bff, #0056b3);\n    color: white;\n    border: none;\n    border-radius: 8px;\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\n    transition: background-color 0.3s ease, transform 0.2s ease;\n    cursor: pointer;\n    width: auto; /* Linh hoạt kích thước */\n    max-width: 200px;\n}\n\n#sendAddress i {\n    font-size: 16px; /* Kích thước icon */\n}\n\n#sendAddress:hover {\n    background: linear-gradient(145deg, #0056b3, #00408a);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);\n}\n\n#sendAddress:active {\n    background: linear-gradient(145deg, #00408a, #003367);\n    transform: translateY(0);\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n}\n\n/* Responsive cho thiết bị nhỏ hơn 768px */\n@media (max-width: 768px) {\n    #sendAddress {\n        width: 90%; /* Chiếm 90% chiều rộng màn hình */\n        max-width: none; /* Loại bỏ giới hạn max-width */\n        padding: 12px 16px; /* Tăng padding để dễ bấm hơn */\n        font-size: 14px;\n        gap: 10px;\n    }\n\n    #sendAddress i {\n        font-size: 18px; /* Icon lớn hơn trên màn hình nhỏ */\n    }\n}\n\n/* Responsive cho thiết bị rất nhỏ hơn 576px */\n@media (max-width: 576px) {\n    #sendAddress {\n        font-size: 13px; /* Cỡ chữ nhỏ hơn */\n        padding: 10px 12px;\n    }\n\n    #sendAddress i {\n        font-size: 16px; /* Giữ icon vừa phải */\n    }\n}\n\n",
    "html": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head>\n\t\t<meta charset=\"UTF-8\">\n\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\t\t<title>Vue Inline Styles</title>\n\t\t<!-- Bootstrap -->\n\t\t<link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n\t\t<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\" />\n\t\t<!-- FontAwesome -->\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css\" integrity=\"sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\n\t</head>\n\t<body>\n\t\t<div id=\"app\">\n\t\t\t<div id=\"map\" class=\"map\"></div>\n\t\t\t<button id=\"sendAddress\" class=\"btn btn-primary mt-2\">\n\t\t\t\t<i class=\"fa-solid fa-location-dot\"></i> Chọn vị trí này\n\t\t\t</button>\n\n\t\t</div>\n\t\t<!-- Vue.js -->\n\t\t<script src=\"https://unpkg.com/vue@2.6.14/dist/vue.min.js\"></script>\n\t\t<script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n\t\t<script src=\"https://cdn.jsdelivr.net/npm/dtuappsmithmap@2.2.20/dist/index.umd.js\"></script>\n\t</body>\n</html>",
    "js": "appsmith.onReady(() => {\n\tfunction createVueInstance() {\n\t\tnew Vue({\n\t\t\tel: \"#app\",\n\t\t\tdata() {\n\t\t\t\treturn {\n\t\t\t\t\tmapInstance: null,\n\t\t\t\t\tcurrentPosition: appsmith.model.map || { lat: 16.0464319, lng: 108.2326082 }, // Default current position\n\t\t\t\t\tsearchPosition: null,\n\t\t\t\t\taddress: appsmith.model.address \n\t\t\t\t};\n\t\t\t},\n\t\t\tasync mounted() {\n\t\t\t\tthis.initMap();\n\t\t\t\tthis.mapInstance.capNhatViTriHienTai(this.currentPosition.lat, this.currentPosition.lng);\n\t\t\t\tif (this.address) {\n\t\t\t\t\tawait this.search(this.address);\n\t\t\t\t}\n\t\t\t\tdocument.getElementById('sendAddress').addEventListener('click', this.sendAddress);\n\t\t\t},\n\t\t\tmethods: {\n\t\t\t\tinitMap() {\n\t\t\t\t\tthis.mapInstance = new DTUAppsmithMap(\"map\", {\n\t\t\t\t\t\tcenter: [this.currentPosition.lat, this.currentPosition.lng],\n\t\t\t\t\t\tzoom: 15,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tasync search(address) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst coordinates = await this.mapInstance.timKiemDiaChi(address);\n\t\t\t\t\t\tthis.searchPosition = coordinates;\n\t\t\t\t\t\tthis.mapInstance.taoDiaDiem(coordinates.lat, coordinates.lng, \"Vị trí tìm kiếm\", this.address, \"fa-solid fa-location-dot\");\n\t\t\t\t\t\tthis.mapInstance.setView([coordinates.lat, coordinates.lng], 16);\n\n\t\t\t\t\t\t// Lưu coordinates vào Appsmith Store để sử dụng ở nơi khác\n\t\t\t\t\t\tappsmith.triggerEvent('changeLocation', { \taddress : this.searchPosition });\n\n\t\t\t\t\t\t// Trigger event with coordinates\n\t\t\t\t\t\t// appsmith.triggerEvent('changeLocation', { location: coordinates || this.currentPosition });\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsendAddress() {\n\t\t\t\t\t// Trigger event with address\n\t\t\t\t\tappsmith.triggerEvent('changeLocation', { \taddress : this.searchPosition || this.currentPosition  });\n\t\t\t\t}\n\t\t\t},\n\t\t\t// watch: {\n\t\t\t// address(newAddress) {\n\t\t\t// if (newAddress) {\n\t\t\t// this.search(newAddress);\n\t\t\t// }\n\t\t\t// }\n\t\t\t// }\n\t\t});\n\t}\n\n\tcreateVueInstance(); // Tạo instance khi Appsmith sẵn sàng\n\n\tappsmith.onModelChange(() => {\n\t\tcreateVueInstance(); // Tạo lại instance khi model thay đổi\n\t});\n});"
  },
  "version": 1,
  "widgetId": "mqadymk8su",
  "widgetName": "Custom1"
}